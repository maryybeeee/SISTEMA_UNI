{% extends 'layout.html' %}
{% block title %}Actualizar Alumno{% endblock %}
{% block content %}
<head>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/profesores_dashboard.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.0/dist/JsBarcode.all.min.js"></script>
    <script>
        function generateUUID() {
            // Genera un UUID único
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                var r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        }
    
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('svg').forEach(function(svg) {
                // Asigna un ID único al SVG
                svg.id = generateUUID();
            });
        });
    </script>
</head>
<body>
    <h2>Actualizar valor del Alumno</h2>
    <div class="container">
        <form action="{{ url_for('edit_record_jornadas', record_id=record['NoControl']) }}" method="post">
            {% for column, value in record.items() %}
                {% if column not in ['NoControl', 'Conteo'] %}
                <div class="form-group">
                    <label for="{{ column }}">{{ column }}:</label>
                    {% if column in ['ApellidoP', 'ApellidoM', 'Nombres'] %}
                    <input type="text" name="{{ column }}" id="{{ column }}" value="{{ value if value is not none else '' }}">
                    {% elif column == 'Estado' %}
                    <select name="Estado" id="Estado">
                        <option value="NO LIBERADO" {{ value == 'NO LIBERADO' and 'selected' }}>NO LIBERADO</option>
                        <option value="LIBERADO" {{ value == 'LIBERADO' and 'selected' }}>LIBERADO</option>
                    </select>
                    {% elif column == 'Atendidos' %}
                    <select name="Atendidos" id="Atendidos">
                        <option value="NO ATENDIDO" {{ value == 'NO ATENDIDO' and 'selected' }}>NO ATENDIDO</option>
                        <option value="ATENDIDO" {{ value == 'ATENDIDO' and 'selected' }}>ATENDIDO</option>
                    </select>
                    {% else %}
                    <div class="checkbox-wrapper">
                        <div class="direcction">
                            {% if value %}
                            <svg id="barcode_{{ column }}" width="200" height="50"></svg>
                            <script>
                                // Generar el código de barras
                                JsBarcode("#barcode_{{ column }}", "{{ value }}", {
                                    format: "CODE128",
                                    lineColor: "#000000",
                                    width: 2,
                                    height: 50,
                                    displayValue: false
                                });
                            </script>
                            {%endif%}
                        </div>
                        <div class="direcction">
                            {% if value %}
                            <label><i class="fas fa-check"></i></label>
                            {% else %}
                            <label><i class="fas fa-times"></i></label>
                            {%endif%}
                            <input type="checkbox" id="large_checkbox_{{ column }}" name="columns_to_clear" value="{{ column }}">
                            <label for="large_checkbox_{{ column }}">Cambiar valor de esta celda</label>
                        </div>
                    </div>
                    {% endif %}
                </div>
                {% endif %}
            {% endfor %}
            <button type="submit" name="save_changes">Guardar Cambios</button><br><br>
            <button type="submit" name="go_back">Regresar</button><br><br>
            <button type="submit" name="remove_record" onclick="return confirm('¿Estás seguro de que deseas eliminar este registro?')">Eliminar Alumno</button>
        </form>           
    </div>
    <script src="{{ url_for('static', filename='js/layout.js') }}"></script>
</body>
{% endblock %}
